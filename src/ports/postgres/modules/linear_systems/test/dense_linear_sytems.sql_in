/* -----------------------------------------------------------------------------
 * Test Dense Linear Systems
 * -------------------------------------------------------------------------- */

DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.linear_system_test_data;
CREATE TABLE MADLIB_TEST_SCHEMA."Linear_systems_test_data" (
    id INTEGER NOT NULL,
    "A" DOUBLE PRECISION[],
    b DOUBLE PRECISION
);

INSERT INTO "Linear_systems_test_data"(id, "A", b) VALUES
(0, ARRAY[1,0,0], 20),
(1, ARRAY[0,1,0], 15),
(2, ARRAY[0,0,1], 20);


-- Note: This install check is meant to check that all the functions exposed to
-- the user work.

-- Checks for the function usage
select linear_solver_dense('help');
select linear_solver_dense('usage');


-- CHECK : Make sure all possible default calls work
DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.result_table;
select linear_solver_dense(
       '"Linear_systems_test_data"',
       'result_table',
       'id',
       '"A"',
       'b',
        NULL,
       'direct',
       'algorithm=llt'
       );

DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.result_table;
select linear_solver_dense(
       '"Linear_systems_test_data"',
       'result_table',
       'id',
       '"A"',
       'b',
        NULL,
       'direct'
       );

DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.result_table;
select linear_solver_dense(
       '"Linear_systems_test_data"',
       'result_table',
       'id',
       '"A"',
       'b',
        NULL
       );

DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.result_table;
select linear_solver_dense(
       '"Linear_systems_test_data"',
       'result_table',
       'id',
       '"A"',
       'b'
       );
DROP TABLE IF EXISTS MADLIB_TEST_SCHEMA.result_table;
